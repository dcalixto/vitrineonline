<div id="fb-root"></div>

<script type="text/javascript">
  $(document)
    .ready(function () {

      window.fbAsyncInit = function () {
        FB.init({appId: '<%= ENV["FACEBOOK_APP_ID"] %>', status: true, cookie: true, xfbml: false});
      };

      (function () {
        var e = document.createElement('script');
        e.async = true;
        e.src = document.location.protocol + '//connect.facebook.net/en_US/all.js';
        document.getElementById('fb-root')
          .appendChild(e);
      }());

      $('#facebook_sign_in').click(function (e) {
        e.preventDefault();
        FB.login(function (response) {
          if (response.authResponse) {
            window.location = '/auth/facebook/callback';
          }
        });
        scope: "email,publish_stream"
      });

      $('#logout_button').click(function (e) {
        FB
          .getLoginStatus(function (response) {
            if (response.authResponse) {
              return FB.logout();
            }
          });
        return true;
      });
    });
</script>
